<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>シンプルな障害物ゲーム</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        .game-area {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #f0f0f0;
            overflow: hidden;
            display: none; /* ゲーム画面はスタート前は非表示 */
        }
        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .start-button {
            padding: 20px 40px;
            font-size: 2rem;
            color: #fff;
            background-color: #28a745;
            border: none;
            cursor: pointer;
            border-radius: 10px;
        }
        .character {
            position: absolute;
            bottom: 20px;
            left: 50px;
            width: 50px;
            height: 50px;
            background-color: blue;
            transition: bottom 0.2s;
        }
        .obstacle {
            position: absolute;
            bottom: 20px;
            right: 0;
            width: 50px;
            height: 50px;
            background-color: red;
            animation: moveObstacle 2s linear infinite;
        }
        @keyframes moveObstacle {
            from {
                right: -50px;
            }
            to {
                right: 100vw;
            }
        }
        .game-over, .game-clear {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: red;
            display: none;
        }
        .game-clear {
            color: green;
        }
        .timer {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5rem;
            color: #000;
        }
    </style>
</head>
<body>

<!-- スタート画面 -->
<div class="start-screen" id="startScreen">
    <button class="start-button" onclick="startGame()">スタート</button>
</div>

<!-- ゲームエリア -->
<div class="game-area" id="gameArea" onclick="jump()">
    <div class="character" id="character"></div>
    <div class="obstacle" id="obstacle"></div>
    <div class="game-over" id="gameOver">ゲームオーバー</div>
    <div class="game-clear" id="gameClear">クリア！</div>
    <div class="timer" id="timer">タイム: 0 秒</div>
</div>

<script>
    let isGameOver = false;
    let timeElapsed = 0;
    let timerInterval;

    function startGame() {
        document.getElementById('startScreen').style.display = 'none'; // スタート画面を非表示
        document.getElementById('gameArea').style.display = 'block';   // ゲーム画面を表示
        isGameOver = false;
        timeElapsed = 0;
        document.getElementById('timer').innerText = `タイム: ${timeElapsed} 秒`;
        timerInterval = setInterval(updateTimer, 1000); // 1秒ごとにタイマーを更新
    }

    function updateTimer() {
        if (!isGameOver) {
            timeElapsed++;
            document.getElementById('timer').innerText = `タイム: ${timeElapsed} 秒`;
            if (timeElapsed >= 30) {
                clearInterval(timerInterval); // タイマーを停止
                clearGame(); // 30秒でクリア
            }
        }
    }

    function jump() {
        if (isGameOver) return;

        const character = document.getElementById('character');
        if (!character.classList.contains('jump')) {
            character.style.bottom = '120px';
            setTimeout(() => {
                character.style.bottom = '20px';
            }, 300);
        }
    }

    function checkCollision() {
        const character = document.getElementById('character');
        const obstacle = document.getElementById('obstacle');
        const gameOverText = document.getElementById('gameOver');

        const charRect = character.getBoundingClientRect();
        const obsRect = obstacle.getBoundingClientRect();

        if (
            charRect.left < obsRect.right &&
            charRect.right > obsRect.left &&
            charRect.top < obsRect.bottom &&
            charRect.bottom > obsRect.top
        ) {
            isGameOver = true;
            clearInterval(timerInterval); // タイマーを停止
            gameOverText.style.display = 'block';
            obstacle.style.animationPlayState = 'paused'; // 障害物の動きを止める
        }
    }

    function clearGame() {
        const gameClearText = document.getElementById('gameClear');
        gameClearText.style.display = 'block'; // クリアメッセージを表示
        document.getElementById('obstacle').style.animationPlayState = 'paused'; // 障害物を止める
        isGameOver = true;
    }

    setInterval(checkCollision, 50); // 50msごとに衝突判定を行う
</script>

</body>
</html>
